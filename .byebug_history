continue
next
current_user.gift_certificates
next
current_user.gift_certificates
next
current_user
next
current_user.gift_certificates
q
next
current_user.gift_certificates
next
amount_left_to_pay
current_user
next
current_user
next
bonuses_payment_amount
next
certificates_payment_amount
next
amount_left_to_pay
next
q
q y
GiftCertificate.unordered.where(token: @certtificates_tokens)q y
GiftCertificate.unordered.where(token: @certtificates_tokens)
GiftCertificate.unordered
next
q
(@certtificates_tokens - GiftCertificate.unordered.map(&:token)).empty?
@certtificates_tokens - GiftCertificate.unordered.map(&:token)
(GiftCertificate.all.map(&:token)-@certtificates_tokens).count
(GiftCertificate.all.map(&:token)-@certtificates_tokens)
GiftCertificate.all.map(&:token)-@certtificates_tokens
GiftCertificate.all.map(&:token).count
@certtificates_tokens - GiftCertificate.all.map(&:token)
GiftCertificate.all.map(&:token)
GiftCertificate.all.map
@certtificates_tokens[0]
GiftCertificate.all.include? @certtificates_tokens[0]
GiftCertificate.all.tokens
GiftCertificate.all.token
GiftCertificate.all
@certtificates_tokens.count
@certtificates_tokens
q
@certtificates_tokens.count
@certtificates_tokens
continue
@certtificates_tokens
certtificates_tokens
continue
next
current_user
order
next
current_user
order
bonuses_payment_amount
next
continue
next
gift_certificate
next
continue
next
continue
params[:quantity].to_i
params
continue
step
continue
step
next
continue
current_user.bonus_points
continue
current_user.bonus_points
current_user.bonus_points - bonuses_payment_amount + real_cash_amount * 0.04
bonuses_payment_amount + real_cash_amount * 0.04
   21:                           - bonuses_payment_amount + real_cash_amount * 0.04
current_user.bonus_points
next
current_user.bonus_points
next
real_cash_amount * 0.04
real_cash_amount
bonuses_payment_amount
current_user.bonus_points
next
continue
next
pay_with_bonuses
next
continue
order.status != "Pending"
order.status
ordet.status
next
order
next
continue
Order.find_by!(id: params[:id])
Order.find!(params[:id])
Order.find_by!(params[:id])
Order.find_by!(params[id])
resource resource_params
params
@order
self.status
self.class
self
resource
continue
params[:user][:amount]
params
current_user
continue
current_user
params
continue
resource_params
params
current_user
continue
current_user
params[:amount].to_i
params[:amount]
params
continue
params
exit
purchase
q
params["purchase"]["quantity"].to_i
currPurchase.quantity
params
q
next
currPurchase
q
currPurchase
q
continue
@current_user
continue
self
self.params
params
@current_user
current_user
session
continue
self.class.superclass.superclass
self.class.superclass
self.class
params
User
user.current_user
session
@session
user: current_user
current_user
session[:user_id]
session
q
@current_user
current_user
q
session
Session.user
Session.all
Session
self
Session.all
Session
session
current_user
@current_user
quit
@current_user
continue
next
*args
next
@current_user
step
@current_user
exit
next
step
next
exit
